var $e=Object.defineProperty,Pe=Object.defineProperties;var Ue=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var je=Object.prototype.hasOwnProperty,me=Object.prototype.propertyIsEnumerable;var re=(e,t,a)=>t in e?$e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a,O=(e,t)=>{for(var a in t||(t={}))je.call(t,a)&&re(e,a,t[a]);if(se)for(var a of se(t))me.call(t,a)&&re(e,a,t[a]);return e},ie=(e,t)=>Pe(e,Ue(t));var de=(e,t,a)=>new Promise((y,E)=>{var K=g=>{try{p(a.next(g))}catch(v){E(v)}},c=g=>{try{p(a.throw(g))}catch(v){E(v)}},p=g=>g.done?y(g.value):Promise.resolve(g.value).then(K,c);p((a=a.apply(e,t)).next())});import{e_ as Ve,e$ as He,f0 as Re,f1 as Ye,f2 as Xe,f3 as qe,ek as ze,eq as oe,f4 as Ge,f5 as Je,f6 as We,f7 as Ze,a as Ce,v as Le,f8 as Qe,c as et,f as I,a8 as P,o as M,h as j,k as i,aC as tt,l as $,j as J,z as m,B as ue,t as he,dM as nt,q as fe,n as A,f9 as at,b9 as lt,F as Z,aB as ct,ch as st,aD as rt,aE as it,fa as dt,b8 as Q,bn as ot,cI as ut,bv as ht,fb as ft,bU as yt,ai as ee,fc as ye,w as pe,an as X,c_ as pt,aq as kt,ax as W,fd as gt,ey as St,L as V,N as Kt,fe as xt,dJ as bt,b3 as Ct,x as ke,y as ge,bG as Lt,az as At,eh as Se,cF as vt,d6 as Et,bs as Ke,cD as _t}from"./index.444718ea.js";import{f as Tt}from"./fromPairs.2341303e.js";import{b as Bt}from"./index.78169a94.js";import{u as wt}from"./useContextMenu.56bbcff1.js";import{g as Ft}from"./get.066b7822.js";var Dt=200;function Nt(e,t,a,y){var E=-1,K=Ye,c=!0,p=e.length,g=[],v=t.length;if(!p)return g;a&&(t=Ve(t,He(a))),y?(K=Xe,c=!1):t.length>=Dt&&(K=qe,c=!1,t=new Re(t));e:for(;++E<p;){var S=e[E],u=a==null?S:a(S);if(S=y||S!==0?S:0,c&&u===u){for(var n=v;n--;)if(t[n]===u)continue e;g.push(S)}else K(t,u,y)||g.push(S)}return g}var Mt=ze(function(e,t){return oe(e)?Nt(e,Ge(t,1,oe,!0)):[]}),It=Mt;function te(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((a,y)=>a+te(e,y),""):Object.keys(t).reduce((a,y)=>a+(t[y]?te(e,y):""),""):""}function Ot(e){return(t,a)=>(t&&typeof t!="string"&&(a=t,t=""),t=t?`${e}__${t}`:e,`${t}${te(t,a)}`)}function Ae(e){return[Ot(`${Je}-${e}`)]}const xe=Symbol(),be=Symbol();function $t(e,t){if(!We(e)||!!e[be])return e;const{values:a,required:y,default:E,type:K,validator:c}=e,p=a||c?g=>{let v=!1,S=[];if(a&&(S=[...a,E],v||(v=S.includes(g))),c&&(v||(v=c(g))),!v&&S.length>0){const u=[...new Set(S)].map(n=>JSON.stringify(n)).join(", ");Ze(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${u}], got value ${JSON.stringify(g)}.`)}return v}:void 0;return{type:typeof K=="object"&&Object.getOwnPropertySymbols(K).includes(xe)?K[xe]:K,required:!!y,default:E,validator:p,[be]:!0}}const Pt=e=>Tt(Object.entries(e).map(([t,a])=>[t,$t(a,t)]));var T=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(T||{});const Ut=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],jt=Pt({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:[Array,Object],default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1},treeWrapperClassName:String}),mt={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},Vt=Ce({__name:"TreeHeader",props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:t}){const a=e,y=Le(""),[E]=Ae("tree-header"),K=Qe(),{t:c}=et(),p=I(()=>{const n=K.headerTitle||a.title;return["mr-1","w-full",{["ml-5"]:n}]}),g=I(()=>{const{checkable:n}=a,s=[{label:c("component.tree.expandAll"),value:T.EXPAND_ALL},{label:c("component.tree.unExpandAll"),value:T.UN_EXPAND_ALL,divider:n}];return n?[{label:c("component.tree.selectAll"),value:T.SELECT_ALL},{label:c("component.tree.unSelectAll"),value:T.UN_SELECT_ALL,divider:n},...s,{label:c("component.tree.checkStrictly"),value:T.CHECK_STRICTLY},{label:c("component.tree.checkUnStrictly"),value:T.CHECK_UN_STRICTLY}]:s});function v(n){var d,h,o,r;const{key:s}=n;switch(s){case T.SELECT_ALL:(d=a.checkAll)==null||d.call(a,!0);break;case T.UN_SELECT_ALL:(h=a.checkAll)==null||h.call(a,!1);break;case T.EXPAND_ALL:(o=a.expandAll)==null||o.call(a,!0);break;case T.UN_EXPAND_ALL:(r=a.expandAll)==null||r.call(a,!1);break;case T.CHECK_STRICTLY:t("strictly-change",!1);break;case T.CHECK_UN_STRICTLY:t("strictly-change",!0);break}}function S(n){t("search",n)}const u=ht(S,200);return P(()=>y.value,n=>{u(n)}),P(()=>a.searchText,n=>{n!==y.value&&(y.value=n)}),(n,s)=>(M(),j("div",{class:fe([i(E)(),"flex px-2 py-1.5 items-center"])},[i(K).headerTitle?tt(n.$slots,"headerTitle",{key:0}):$("",!0),!i(K).headerTitle&&n.title?(M(),J(i(nt),{key:1,helpMessage:n.helpMessage},{default:m(()=>[ue(he(n.title),1)]),_:1},8,["helpMessage"])):$("",!0),n.search||n.toolbar?(M(),j("div",mt,[n.search?(M(),j("div",{key:0,class:fe(i(p))},[A(i(at),{placeholder:i(c)("common.searchText"),size:"small",allowClear:"",value:y.value,"onUpdate:value":s[0]||(s[0]=d=>y.value=d)},null,8,["placeholder","value"])],2)):$("",!0),n.toolbar?(M(),J(i(ut),{key:1,onClick:s[1]||(s[1]=ot(()=>{},["prevent"]))},{overlay:m(()=>[A(i(lt),{onClick:v},{default:m(()=>[(M(!0),j(Z,null,ct(i(g),d=>(M(),j(Z,{key:d.value},[A(i(st),rt(it({key:d.value})),{default:m(()=>[ue(he(d.label),1)]),_:2},1040),d.divider?(M(),J(i(dt),{key:0})):$("",!0)],64))),128))]),_:1})]),default:m(()=>[A(i(Q),{icon:"ion:ellipsis-vertical"})]),_:1})):$("",!0)])):$("",!0)],2))}}),Ht=({icon:e})=>e?ft(e)?yt(Q,{icon:e,class:"mr-1"}):Q:null;function Rt(e,t){function a(u){const n=[],s=u||i(e),{key:d,children:h}=i(t);if(!h||!d)return n;for(let o=0;o<s.length;o++){const r=s[o];n.push(r[d]);const k=r[h];k&&k.length&&n.push(...a(k))}return n}function y(u){const n=[],s=u||i(e),{key:d,children:h}=i(t);if(!h||!d)return n;for(let o=0;o<s.length;o++){const r=s[o];r.disabled!==!0&&r.selectable!==!1&&n.push(r[d]);const k=r[h];k&&k.length&&n.push(...y(k))}return n}function E(u,n){const s=[],d=n||i(e),{key:h,children:o}=i(t);if(!o||!h)return s;for(let r=0;r<d.length;r++){const k=d[r],_=k[o];u===k[h]?(s.push(k[h]),_&&_.length&&s.push(...a(_))):_&&_.length&&s.push(...E(u,_))}return s}function K(u,n,s){if(!u)return;const d=s||i(e),{key:h,children:o}=i(t);if(!(!o||!h))for(let r=0;r<d.length;r++){const k=d[r],_=k[o];if(k[h]===u){d[r]=O(O({},d[r]),n);break}else _&&_.length&&K(u,n,k[o])}}function c(u=1,n,s=1){if(!u)return[];const d=[],h=n||i(e)||[];for(let o=0;o<h.length;o++){const r=h[o],{key:k,children:_}=i(t),q=k?r[k]:"",U=_?r[_]:[];d.push(q),U&&U.length&&s<u&&(s+=1,d.push(...c(u,U,s)))}return d}function p({parentKey:u=null,node:n,push:s="push"}){const d=ee(i(e));if(!u){d[s](n),e.value=d;return}const{key:h,children:o}=i(t);!o||!h||(ye(d,r=>{if(r[h]===u)return r[o]=r[o]||[],r[o][s](n),!0}),e.value=d)}function g({parentKey:u=null,list:n,push:s="push"}){const d=ee(i(e));if(!(!n||n.length<1))if(u){const{key:h,children:o}=i(t);if(!o||!h)return;ye(d,r=>{if(r[h]===u){r[o]=r[o]||[];for(let k=0;k<n.length;k++)r[o][s](n[k]);return e.value=d,!0}})}else for(let h=0;h<n.length;h++)d[s](n[h])}function v(u,n){if(!u)return;const s=n||i(e),{key:d,children:h}=i(t);if(!(!h||!d))for(let o=0;o<s.length;o++){const r=s[o],k=r[h];if(r[d]===u){s.splice(o,1);break}else k&&k.length&&v(u,r[h])}}function S(u,n,s){if(!u&&u!==0)return null;const d=n||i(e),{key:h,children:o}=i(t);if(!!h)return d.forEach(r=>{if((s==null?void 0:s.key)||(s==null?void 0:s.key)===0)return s;if(r[h]===u){s=r;return}r[o]&&r[o].length&&(s=S(u,r[o],s))}),s||null}return{deleteNodeByKey:v,insertNodeByKey:p,insertNodesByKey:g,filterByLevel:c,updateNodeByKey:K,getAllKeys:a,getChildrenKeys:E,getEnabledKeys:y,getSelectedNode:S}}function Yt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!vt(e)}var Zt=Ce({name:"BasicTree",inheritAttrs:!1,props:jt,emits:Ut,setup(e,{attrs:t,slots:a,emit:y,expose:E}){const[K]=Ae("tree"),c=pe({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),p=pe({startSearch:!1,searchText:"",searchData:[]}),g=Le([]),[v]=wt(),S=I(()=>{const{fieldNames:l}=e;return O({children:"children",title:"title",key:"key"},l)}),u=I(()=>{let l=ie(O(O({blockNode:!0},t),e),{expandedKeys:c.expandedKeys,selectedKeys:c.selectedKeys,checkedKeys:c.checkedKeys,checkStrictly:c.checkStrictly,fieldNames:i(S),"onUpdate:expandedKeys":f=>{c.expandedKeys=f,y("update:expandedKeys",f)},"onUpdate:selectedKeys":f=>{c.selectedKeys=f,y("update:selectedKeys",f)},onCheck:(f,C)=>{let x=X(c.checkedKeys);if(pt(x)&&p.startSearch){const L=C.node.eventKey;x=It(x,q(L)),C.checked&&x.push(L),c.checkedKeys=x}else c.checkedKeys=f;const b=X(c.checkedKeys);y("update:value",b),y("check",b,C)},onRightClick:_e});return kt(l,"treeData","class")}),n=I(()=>p.startSearch?p.searchData:i(g)),s=I(()=>!n.value||n.value.length===0),{deleteNodeByKey:d,insertNodeByKey:h,insertNodesByKey:o,filterByLevel:r,updateNodeByKey:k,getAllKeys:_,getChildrenKeys:q,getEnabledKeys:U,getSelectedNode:ve}=Rt(g,S);function Ee(l,f){return!f&&e.renderIcon&&W(e.renderIcon)?e.renderIcon(l):f}function _e(C){return de(this,arguments,function*({event:l,node:f}){var F;const{rightMenuList:x=[],beforeRightClick:b}=e;let L={event:l,items:[]};if(b&&W(b)){let B=yield b(f,l);Array.isArray(B)?L.items=B:Object.assign(L,B)}else L.items=x;!((F=L.items)!=null&&F.length)||(L.items=L.items.filter(B=>!B.hidden),v(L))})}function H(l){c.expandedKeys=l}function Te(){return c.expandedKeys}function ne(l){c.selectedKeys=l}function Be(){return c.selectedKeys}function ae(l){c.checkedKeys=l}function we(){return c.checkedKeys}function le(l){c.checkedKeys=l?U():[]}function z(l){c.expandedKeys=l?_():[]}function Fe(l){c.checkStrictly=l}P(()=>e.searchValue,l=>{l!==p.searchText&&(p.searchText=l)},{immediate:!0}),P(()=>e.treeData,l=>{l&&G(p.searchText)});function G(l){if(l!==p.searchText&&(p.searchText=l),y("update:searchValue",l),!l){p.startSearch=!1;return}const{filterFn:f,checkable:C,expandOnSearch:x,checkOnSearch:b,selectedOnSearch:L}=i(e);p.startSearch=!0;const{title:F,key:B}=i(S),D=[];if(p.searchData=gt(i(g),w=>{var R,Y;const N=f?f(l,w,i(S)):(Y=(R=w[F])==null?void 0:R.includes(l))!=null?Y:!1;return N&&D.push(w[B]),N},i(S)),x){const w=St(p.searchData).map(N=>N[B]);w&&w.length&&H(w)}b&&C&&D.length&&ae(D),L&&D.length&&ne(D)}function De(l,f){if(!(!e.clickRowToExpand||!f||f.length===0))if(!c.expandedKeys.includes(l))H([...c.expandedKeys,l]);else{const C=[...c.expandedKeys],x=C.findIndex(b=>b===l);x!==-1&&C.splice(x,1),H(C)}}V(()=>{g.value=e.treeData}),Kt(()=>{const l=parseInt(e.defaultExpandLevel);l>0?c.expandedKeys=r(l):e.defaultExpandAll&&z(!0)}),V(()=>{c.expandedKeys=e.expandedKeys}),V(()=>{c.selectedKeys=e.selectedKeys}),V(()=>{c.checkedKeys=e.checkedKeys}),P(()=>e.value,()=>{c.checkedKeys=X(e.value||[])},{immediate:!0}),P(()=>c.checkedKeys,()=>{const l=X(c.checkedKeys);y("update:value",l),y("change",l)}),V(()=>{c.checkStrictly=e.checkStrictly});const Ne={setExpandedKeys:H,getExpandedKeys:Te,setSelectedKeys:ne,getSelectedKeys:Be,setCheckedKeys:ae,getCheckedKeys:we,insertNodeByKey:h,insertNodesByKey:o,deleteNodeByKey:d,updateNodeByKey:k,getSelectedNode:ve,checkAll:le,expandAll:z,filterByLevel:l=>{c.expandedKeys=r(l)},setSearchValue:l=>{G(l)},getSearchValue:()=>p.searchText};function Me(l){const{actionList:f}=e;if(!(!f||f.length===0))return f.map((C,x)=>{var L;let b=!0;return W(C.show)?b=(L=C.show)==null?void 0:L.call(C,l):Ke(C.show)&&(b=C.show),b?A("span",{key:x,class:K("action")},[C.render(l)]):null})}const Ie=I(()=>{const l=ee(n.value);return xt(l,(f,C)=>{var ce;const x=p.searchText,{highlight:b}=i(e),{title:L,key:F,children:B}=i(S),D=Ee(f,f.icon),w=Ft(f,L),N=x?w.indexOf(x):-1,R=p.startSearch&&!Et(x)&&b&&N!==-1,Y=`color: ${Ke(b)?"#f50":b}`,Oe=R?A("span",{class:(ce=i(u))!=null&&ce.blockNode?`${K("content")}`:""},[A("span",null,[w.substr(0,N)]),A("span",{style:Y},[x]),A("span",null,[w.substr(N+x.length)])]):w;return f[L]=A("span",{class:`${K("title")} pl-2`,onClick:De.bind(null,f[F],f[B])},[a!=null&&a.title?_t(a,"title",f):A(Z,null,[D&&A(Ht,{icon:D},null),Oe,A("span",{class:K("actions")},[Me(f)])])]),f}),l});return E(Ne),()=>{let l;const{title:f,helpMessage:C,toolbar:x,search:b,checkable:L}=e,F=f||x||b||a.headerTitle,B={height:"calc(100% - 38px)"};return A("div",{class:[K(),"h-full",t.class]},[F&&A(Vt,{checkable:L,checkAll:le,expandAll:z,title:f,search:b,toolbar:x,helpMessage:C,onStrictlyChange:Fe,onSearch:G,searchText:p.searchText},Yt(l=bt(a))?l:{default:()=>[l]}),A(Ct,{wrapperClassName:i(e.treeWrapperClassName),spinning:i(e.loading),tip:"\u52A0\u8F7D\u4E2D..."},{default:()=>[ke(A(Lt,{style:B},{default:()=>[A(Bt,At(i(u),{showIcon:!1,treeData:Ie.value}),null)]}),[[ge,!i(s)]]),ke(A(Se,{image:Se.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[ge,i(s)]])]})])}}});export{Zt as _};
